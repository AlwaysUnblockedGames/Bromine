---
---
<script type="module" defer>
  import { setTransport, setWisp, setProxy, makeURL, getProxied } from './lethal.mjs';

  const form = document.getElementById('form');
  const addressInput = document.getElementById("address");
  const search = localStorage.getItem("search-engine") || "https://search.brave.com/search?q=%s";

  if (navigator.userAgent.indexOf("Firefox") > 0) setTransport('libcurl');
  else setTransport("epoxy");

  setProxy("scram");

  setWisp("wss://anura.pro/")
  // setWisp('wss://wisp.mercurywork.shop/wisp/');

  form.addEventListener("submit", async (event) => {
    event.preventDefault();
    const frame = document.getElementById('frame');
    const urlToLoad = makeURL(addressInput.value, search);


    addressInput.value = urlToLoad;
    frame.src = await getProxied(urlToLoad); 
  });
</script>
